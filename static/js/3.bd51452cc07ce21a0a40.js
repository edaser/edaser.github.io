webpackJsonp([3],{BLMs:function(e,n){},IS4G:function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("mvHQ"),o=i.n(a),s=i("gyMJ"),l={created:function(){var e=this.$route.params,n=e.identifier,t=e.challenge_id;this.identifier=n,this.challenge_id=parseInt(t),this.refresh()},components:{MarkdownEditor:function(){return i.e(8).then(i.bind(null,"WVAU"))}},data:function(){return{editorLoading:!1,initialized:!1,content:"\x3c!--请使用markdown语法书写--\x3e\n## 基础知识\n\n#### 第一个知识点\n\n正文正文\n\n## 编程实战\n\n```\n// 代码\n// code here ...\n```\n\n\n## 参考资料\n\n\n1. [参考资料1](www.xxxxxx.com)\n\n2. [markdown语法](https://www.jianshu.com/p/191d1e21f7ed)\n\n",shixun:{},challenge:{},nickname:"",email:"",note_id:"",editorConfig:{width:"auto",toolbars:{undo:!0,redo:!0,italic:!1,overline:!1,h1:!1,h3:!1,h4:!0,hr:!1,quote:!1,link:!0,image:!0,uploadImage:!0,table:!1,checked:!1,notChecked:!1,print:!1,theme:!1,exportmd:!0,importmd:!0,save:!0,clear:!1}}}},methods:{refresh:function(){var n=this,t=this.identifier,i=this.challenge_id;Object(s.a)({name:"shixun",data:{identifier:t,random:123},config:{method:"get"}}).then(function(t){n.shixun=t.data.shixun;var a=t.data.challenge_list.filter(function(e){return e.challenge_id==i})[0];if(console.log(n.challenge),a)n.challenge=a,n.initialized=!0,n.loadContent(),n.enableOnLeaveNotice();else{n.initialized=!1;n.$loading({lock:!0,text:"实训数据获取失败",spinner:"el-icon-warning-outline",background:"rgba(0, 0, 0, 0.7)"});n.$msgbox({title:"错误提示",message:e.message||"实训数据获取失败",type:"error"})}n.loading=!1,document.title="分享题解 | "+n.shixun.name}).catch(function(e){n.loading=!1,n.$msgbox({title:"错误提示",message:e.message||"数据获取失败",type:"error"})})},enableOnLeaveNotice:function(){console.log("enableOnLeaveNotice");var e=this;window.onbeforeunload=function(n){console.log("onbeforeunload"),e.saveContent(),(n=n||window.event).returnValue=" "}},onSubmit:function(){var n=this;if(this.initialized){var t=this.$loading({lock:!0,text:"提交中"}),i=this.nickname,a=this.note_id,o=this.email,l=this.shixun.name,c=this.challenge.name,r=this.content,d=this.challenge_id,h=this.identifier;Object(s.a)({name:"createNote",data:{note_id:a,nickname:i,email:o,content:r,challenge_id:d,shixun_identifier:h,shixun_name:l,challenge_name:c}}).then(function(e){console.log(e),n.note_id=e.data.note_id,t.close(),n.$msgbox({type:"success",message:"请等待审核通过",title:"提交成功"})}).catch(function(e){t.close(),n.$msgbox({type:"error",message:"数据提交失败",title:"错误提示"})})}else this.$msgbox({title:"错误提示",message:e.message||"实训数据获取失败",type:"error"})},onSave:function(e,n,t){console.log("on save",e,n,t);var i=e.from;this.saveContent(),"click"==i&&this.$notify({type:"success",message:"文本已在本地缓存",title:"提示"})},saveContent:function(){console.debug("save content");var e=this.nickname,n=this.note_id,t=this.email,i=this.content,a="note_"+this.challenge_id;localStorage.setItem(a,o()({nickname:e,note_id:n,email:t,content:i}))},loadContent:function(){console.debug("load content");var e="note_"+this.challenge_id,n=localStorage.getItem(e);if(n){var t=JSON.parse(n),i=t.nickname,a=t.note_id,o=t.content,s=t.email;this.note_id=a,this.nickname=i,this.content=o,this.email=s}},onEditorReady:function(e){var n=e.vm;console.info("editor created",n),this.editor=n},onUploadImage:function(e){var n=this;console.info("onUploadImage",e,arguments);var t=new FormData;t.append("file",e),console.log(t),this.editorLoading=!0,this.$http.post("https://educoder-answer-s87vg-1302719275.ap-shanghai.service.tcloudbase.com/api?name=uploadAttachment",t).then(function(e){console.log(e);var t=e.data,i=t.status,a=t.message,o=t.data;0==i?n.editor.insertContent("![](https://ali-cdn.educoder.net/api/attachments/"+o.id+")"):n.$notify("error",a||"图片上传失败"),n.editorLoading=!1}).catch(function(e){n.editorLoading=!1,n.$notify("error",e.message||"图片上传失败")})},onPasteImage:function(e,n,t,i){console.info("on paste image",e,n,t,i)}}},c={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticStyle:{padding:"0 6vw"}},[e.shixun.name?t("h1",[e._v("\n    实训题解编写与分享\n    "),t("el-link",{attrs:{type:"primary",href:"https://www.jianshu.com/p/191d1e21f7ed",target:"_blank"}},[e._v("markdown语法\n       "),t("i",{staticClass:"el-icon-link el-icon--right"})])],1):e._e(),e._v(" "),e.challenge.name?t("h3",[e._v("\n    实训："+e._s(e.shixun.name)+" - 第"+e._s(e.challenge.position)+"关："+e._s(e.challenge.name)+"\n    "),t("el-link",{attrs:{target:"_blank",type:"primary",href:"https://www.educoder.net/shixuns/"+e.identifier+"/challenges"}},[e._v("\n      打开实训\n      "),t("i",{staticClass:"el-icon-link el-icon--right"})])],1):e._e(),e._v(" "),t("MarkdownEditor",{directives:[{name:"loading",rawName:"v-loading",value:e.editorLoading,expression:"editorLoading"}],attrs:{width:e.editorConfig.width,toolbars:e.editorConfig.toolbars,autoSave:!0,interval:1e4},on:{"on-save":e.onSave,"on-ready":e.onEditorReady,"on-upload-image":e.onUploadImage,"on-paste-image":e.onPasteImage},model:{value:e.content,callback:function(n){e.content=n},expression:"content"}}),e._v(" "),t("div",{staticClass:"foot-form"},[t("el-input",{staticClass:"input",attrs:{placeholder:"作者昵称（选填）"},model:{value:e.nickname,callback:function(n){e.nickname=n},expression:"nickname"}}),e._v(" "),t("el-input",{staticClass:"input",attrs:{placeholder:"作者邮箱（选填）"},model:{value:e.email,callback:function(n){e.email=n},expression:"email"}}),e._v(" "),t("el-button",{attrs:{type:"primary",round:"",disabled:!e.initialized},on:{click:e.onSubmit}},[e._v("分享题解")])],1)],1)},staticRenderFns:[]};var r=i("VU/8")(l,c,!1,function(e){i("BLMs")},"data-v-ba6217e6",null);t.default=r.exports}});